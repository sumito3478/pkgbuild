# $Id$
# Maintainer: sumito3478 <sumito3478@gmail.com>

# maintainer of the original package
# Maintainer: Lukas Jirkovsky <l.jirkovsky@gmail.com>

pkgname=priv-intellij-idea-community-edition
pkgver=13.1.1
_pkgver=135.480
pkgrel=1
pkgdesc="IDE for Java, Groovy and other programming languages with advanced refactoring features"
arch=('x86_64')
url="http://www.jetbrains.org/"
license=('Apache')
depends=('java-environment' 'giflib')
install=idea.install
source=(http://download.jetbrains.com/idea/ideaIC-$pkgver.tar.gz \
        idea.desktop idea.sh vmoptions.diff)
conflicts=('intellij-idea-community-edition' 'intellij-idea-libs')
provides=("intellij-idea-community-edition=$pkgver" "intellij-idea-libs=$pkgver")

build() {
  cd "$srcdir/idea-IC-$_pkgver"
  patch -p1 < "$srcdir/vmoptions.diff"
}

package() {
  install -d -m755 "$pkgdir/"usr/share
  cp -a "idea-IC-$_pkgver" "$pkgdir"/usr/share/intellijidea-ce

  # rm "$pkgdir"/usr/share/intellijidea-ce/bin/{fsnotifier,libbreakgen}

  # make sure that all files are owned by root
  chown -R root:root "$pkgdir/usr/share"

  # never wait on user input when starting idea
  sed -i '/.*read IGNORE.*/ d' "$pkgdir"/usr/share/intellijidea-ce/bin/idea.sh

  install -D -m755 "$srcdir"/idea.sh "$pkgdir"/usr/bin/idea.sh
  install -D -m644 "$srcdir"/idea.desktop "$pkgdir"/usr/share/applications/idea.desktop
  install -D -m644 "$pkgdir"/usr/share/intellijidea-ce/bin/idea.png \
                   "$pkgdir"/usr/share/pixmaps/idea.png
}

# vim:set ts=2 sw=2 et:
md5sums=('a20ade9bc4addbc341af8dcc1a0830ce'
         '29e2d4ab0578a6d44533292bec8843ee'
         'f27bad35ee8e6445ca2f8a591bca895a'
         'dd270d94f0420c35249045aec344e7dd')
